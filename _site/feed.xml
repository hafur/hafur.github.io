<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.0">Jekyll</generator><link href="delphi.hafur.com/feed.xml" rel="self" type="application/atom+xml" /><link href="delphi.hafur.com/" rel="alternate" type="text/html" /><updated>2021-05-02T21:27:18+02:00</updated><id>delphi.hafur.com/feed.xml</id><title type="html">delphi.hafur.com</title><subtitle>Random thoughts about random stuff.</subtitle><entry><title type="html">Homepage Automation Workflow</title><link href="delphi.hafur.com/2020/04/14/Homepage-Automation.html" rel="alternate" type="text/html" title="Homepage Automation Workflow" /><published>2020-04-14T00:00:00+02:00</published><updated>2020-04-14T00:00:00+02:00</updated><id>delphi.hafur.com/2020/04/14/Homepage-Automation</id><content type="html" xml:base="delphi.hafur.com/2020/04/14/Homepage-Automation.html">&lt;p&gt;My new setup is running pretty stable so far. As mentioned before, my homepage is now fully hosted on an always free compute instance on Oracle Cloud Infrastructure.
There was no downtime and I do not eperience any performace challanges. However, I am pretty certain that people from Australia will definitley experience slower performance than someone in Germany. As of now I am running the compute instance in the Frankfurt OCI Region. 
Plan is to eventally set up another compute instance (you get 2 always free instances in OCI) in another region (maybe Australia or US) and then use the &lt;a href=&quot;https://docs.oracle.com/en-us/iaas/Content/TrafficManagement/Concepts/overview.htm&quot;&gt;Traffic Management Steering Policies Service&lt;/a&gt; to route traffic based on the geographical region of a request - that is something for the future.&lt;/p&gt;

&lt;h3 id=&quot;the-issue&quot;&gt;The Issue&lt;/h3&gt;
&lt;p&gt;In this post, I want to discuss how I automated my homepage. My homepage is very simple: just a list of photos. You can click on the thumbmnail to see a larger version of the photo. The larger version displays the location of where the photo was taken.
It is plain simple static HTML code using CSS for the styling and a bit of JavaScript to enable the effect when moving over the thubmnail and also to create the overlay to view the larger version of a photo.&lt;/p&gt;

&lt;p&gt;As plain as simple as it is - there is a major pain: whenever I want to add a new photo, I have to update the html code. It is a fairly simple update (copy and paste - literally) but nevertheless it is a very annoying process. Since the actual manual effort required is to plain simple, I thought there must be a way that &lt;em&gt;even I&lt;/em&gt; should be able to come up with a more automated soution.&lt;/p&gt;

&lt;h3 id=&quot;the-solution&quot;&gt;The Solution&lt;/h3&gt;

&lt;p&gt;The manual process comprises two steps:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Manual upload of new photos to folder on web server via ftp&lt;/li&gt;
  &lt;li&gt;Update html to include the new photos&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;In my mind, the automation should work like this:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Upload photos to web server via ftp&lt;/li&gt;
  &lt;li&gt;Html code is automatically updated&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Because step 1 is actually a little bit of a security concern (I dont want to expose my web server on port 21), I came up with this final process:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Upload photos to a &lt;em&gt;input&lt;/em&gt; folder via ftp&lt;/li&gt;
  &lt;li&gt;A script copies the new photos to the web server&lt;/li&gt;
  &lt;li&gt;Same script will also generate the new html code&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Something like this:
&lt;img src=&quot;/assets/20200414/hafurflow.png&quot; alt=&quot;homepage automation&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;the-script&quot;&gt;The Script&lt;/h4&gt;

&lt;p&gt;The script is a mix of Python and bash code. 
The Python script manages the generation of the html code. The main work is done using the &lt;a href=&quot;https://pypi.org/project/dominate/&quot;&gt;dominate library&lt;/a&gt; which is a Python library for creating and manipulating HTML documents.&lt;/p&gt;

&lt;p&gt;For example, the header part of my home page is generated by these few lines of Python code:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;import dominate, glob, os
from dominate.tags import *

doc = dominate.document(title='hafur.com | photos of the world unite!')

with doc.head:
meta(name='Description', content='Photos of the world unite! Photos from different places in the world united on one web page.')
meta(charset='utf-8')
meta(name='viewport', content='width=device-width, initial-scale=1')
link(rel='stylesheet', href='assets/css/main.css')
.
.
.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The actual gallery is emmbedded in a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;section&lt;/code&gt; element using several &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;div&lt;/code&gt;elements. So in the manual old world, this is were I had top copy&amp;amp;paste some new &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;div&lt;/code&gt; elements and add the proper link to the new photo.
That is the part which is now automated by the following &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;for&lt;/code&gt; loop:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;for i in reversed(sorted(glob.glob(&quot;/webserver/images/fulls/*&quot;), key=os.path.getmtime)):
    _media_div = _cont_div.add(div(cls='media all place'))
    _photo = _media_div.add(a(href='%s' % i[14:]))
    _src = _photo.add(img(src=i.replace('fulls' , 'thumbs')[14:],title=os.path.basename(i)[9:-4]))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;What happens here is that the script looks at all photos in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fulls&lt;/code&gt; directory on my web server and creates for each image the required &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;div&lt;/code&gt; elements. Furthermore, it uses thumbnails for efficiency which are located in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;thumbs&lt;/code&gt; directory - the script replaces simply the word &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fulls&lt;/code&gt; with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;thumbs&lt;/code&gt; (the filenames are the same).
Finally, it uses the filename of each photo to generate the title (which is displayed when clicking on a thumbnail). All photos have the same filename pattern: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;YYYYMMDD_City, Country.jpg&lt;/code&gt;.
So the title is the filename minus the date and the filename extension: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;City, Country&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The whole Python script is wrapped by a bash script which moves the images files from the ftp input directory to the web server directory. And that’s it folks!&lt;/p&gt;

&lt;p&gt;Now, I upload new photos including a custom made thumbnail via ftp to my compute instance and then start my &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;update.sh&lt;/code&gt; script which takes care of the html code updates and that the files are located in the right directory.&lt;/p&gt;</content><author><name></name></author><category term="python homepage" /><summary type="html">My new setup is running pretty stable so far. As mentioned before, my homepage is now fully hosted on an always free compute instance on Oracle Cloud Infrastructure. There was no downtime and I do not eperience any performace challanges. However, I am pretty certain that people from Australia will definitley experience slower performance than someone in Germany. As of now I am running the compute instance in the Frankfurt OCI Region. Plan is to eventally set up another compute instance (you get 2 always free instances in OCI) in another region (maybe Australia or US) and then use the Traffic Management Steering Policies Service to route traffic based on the geographical region of a request - that is something for the future.</summary></entry><entry><title type="html">A new webserver in OCI</title><link href="delphi.hafur.com/2020/02/28/A-new-webserver-in-OCI.html" rel="alternate" type="text/html" title="A new webserver in OCI" /><published>2020-02-28T00:00:00+01:00</published><updated>2020-02-28T00:00:00+01:00</updated><id>delphi.hafur.com/2020/02/28/A-new-webserver-in-OCI</id><content type="html" xml:base="delphi.hafur.com/2020/02/28/A-new-webserver-in-OCI.html">&lt;p&gt;As mentioned in the previous post, I will try to get my homepage set up on a webserver running on a virtual machine with in the Oracle Cloud Infrastructure.
Oracle is offering an ‘Always free’ account which comes with 2 VMs, a couple of databases and some other services. Interestingly, I can also get a Load Balancer which could help setting up some HA approaches by distributing the web server over two VMs.
But first things first: Lets start with one VM first&lt;/p&gt;

&lt;h2 id=&quot;technical-details&quot;&gt;Technical Details&lt;/h2&gt;
&lt;p&gt;There are a bunch of tutorials out there which describe how to set up a VM in OCI. It is no rocket science whatsoever. You need a Virtual Cloud Network (which can be set up automatically during the provisioning of the VM) and of you go. 
One thing to note though: I have used my own ssh key in the configuration process and did not opt for the option where Oracle provide&lt;/p&gt;

&lt;p&gt;Let me give you an idea of what my OCI webserver comprises:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Ubuntu 18.04 LTS&lt;/li&gt;
  &lt;li&gt;nginx (I only knew Apache so nginx is a new experience)&lt;/li&gt;
  &lt;li&gt;Let’s encrypyt SSL certificate via Certbot&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Pretty minimalist, I reckon. 
I will not go into details on how to set up all of that: Google is your friend. There is a ton of tutorials out there and all of the above is really straight forward.
The only thing that kept me busy for while was the security of this darn thing. I actually should not complain. Oracle claims that OCI is ‘secure by default’ and that is actually true. 
As part of their virtual cloud networking, Oracle provides a Network Security List to configure ingress and egress traffic to and from your services that are deployed in a particular Virtual Cloud Network (VCN). 
For my use case I require a rule that allows incoming traffic on TCP port 80 and 443. Really easy to set up as a matter of fact.
This is what the rule table looks like after I added my rules for port 80 and 443:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/nsl.png&quot; alt=&quot;My NSL&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Excited about how fast everything was set up and configured, I threw my shiny, new public IP at my browser of choice just to be completely shattered.
It did not work. I was expecting some default nginx welcome page but my browser would just return errors.&lt;/p&gt;

&lt;p&gt;I checked the nginc config on the server, made sure I could do a curl on the localhost. All and everything was working - as long as I was doing the test on the actual server.&lt;/p&gt;

&lt;p&gt;It took my some time (mainly because I ignored the documentation - RTFM? No not for me.
Remember: OCI is secure by default. That means that Oracle put an actual firewall on the Ubuntu image. As a matter of fact, every Linux distro you can use to fire up a VMs will have a firewall enabled by default. And the default configuration allows only ssh traffic!&lt;/p&gt;

&lt;p&gt;Well - fair enough: I do know Ubuntu Firewall (that &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ufw&lt;/code&gt; thing). Would have been too easy. In OCI the images come with a proper &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;iptables&lt;/code&gt; firewall config - which I do not know.&lt;/p&gt;

&lt;p&gt;There is a bunch of information on &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;iptables&lt;/code&gt; out there. Really! A lot! And I really feel it is a complex topic - naturally security is always a complex topic.&lt;/p&gt;

&lt;p&gt;To keep it short - here is the solution (I would not recommend this for a production system):
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo iptables -I INPUT 6 -m state --state NEW -p tcp --dport 80 -j ACCEPT&lt;/code&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo iptables -I INPUT 6 -m state --state NEW -p tcp --dport 443 -j ACCEPT&lt;/code&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo netfilter-persistent save&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;For reference: &lt;a href=&quot;https://docs.oracle.com/en-us/iaas/developer-tutorials/tutorials/apache-on-ubuntu/01oci-ubuntu-apache-summary.htm&quot;&gt;OCI-Ubuntu-Apache Tutorial&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Horray! It is working!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/Webserver.png&quot; alt=&quot;OCI webserver architecture&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Final step: Creating an DNS A-record for the IP address at my domain provider et voila: My homepage is now hosted on an ‘always free’ compute instance n Oracle Cloud Infrastructure.&lt;/p&gt;

&lt;p&gt;Now I have to evaluate how robust this solution is.
I figure the main thing to worry about is maintenance of the webserver, i.e. applying patches etc.
We will see…&lt;/p&gt;</content><author><name></name></author><category term="cloud oracle" /><summary type="html">As mentioned in the previous post, I will try to get my homepage set up on a webserver running on a virtual machine with in the Oracle Cloud Infrastructure. Oracle is offering an ‘Always free’ account which comes with 2 VMs, a couple of databases and some other services. Interestingly, I can also get a Load Balancer which could help setting up some HA approaches by distributing the web server over two VMs. But first things first: Lets start with one VM first</summary></entry><entry><title type="html">Self-hosting for more Flexibility</title><link href="delphi.hafur.com/2020/02/27/Homepage-Automation-on-OCI.html" rel="alternate" type="text/html" title="Self-hosting for more Flexibility" /><published>2020-02-27T00:00:00+01:00</published><updated>2020-02-27T00:00:00+01:00</updated><id>delphi.hafur.com/2020/02/27/Homepage-Automation-on-OCI</id><content type="html" xml:base="delphi.hafur.com/2020/02/27/Homepage-Automation-on-OCI.html">&lt;p&gt;Every company is adjusting services and products they are offering - usually that comes at a price, namely the actual &lt;em&gt;value for what you get&lt;/em&gt;. Usually, you get less value for the same price.&lt;/p&gt;

&lt;p&gt;Companies like to reduce the content but maintain the same price. There are websites in Germany which document this behaviour, for example &lt;a href=&quot;https://www.vzhh.de/themen/mogelpackungen/weniger-drin-preis-gleich-die-neuesten-mogelpackungen&quot;&gt;VZHH&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Why am I mentioning this? Well, my domin provider of choice &lt;a href=&quot;https://www.one.com&quot;&gt;one.com&lt;/a&gt; is guilty of the same unfortunate behaviour. I have been a customer for over 15 years and I have seen changes and adjustments to their services - which is normal. Unfortunately, with every adjustment it seems I am losing more and more functionality to an extend where I am questioning the price-value ratio.
In my previous post, I described how I am revaluating my current set up. The first step is to decouple my homepage, i.e. the webserver from my domain provider. I will use Oracle Cloud Infrastructure to host my web server and create an DNS A-Record to point my domain to the IP address of that web server.
This is what it will look like:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/homepage.png&quot; alt=&quot;Future Architecture&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In the next few posts, I will describe the process of migrating my homepage to a web server which I have to maintain. This includes setting up the network, securing the whole server and the webpage, etc.&lt;/p&gt;

&lt;p&gt;First step: Get the virtual machine up and running.!&lt;/p&gt;</content><author><name></name></author><category term="cloud" /><summary type="html">Every company is adjusting services and products they are offering - usually that comes at a price, namely the actual value for what you get. Usually, you get less value for the same price.</summary></entry><entry><title type="html">What do I really need?</title><link href="delphi.hafur.com/2020/02/24/What-I-need-from-my-domain-provider.html" rel="alternate" type="text/html" title="What do I really need?" /><published>2020-02-24T00:00:00+01:00</published><updated>2020-02-24T00:00:00+01:00</updated><id>delphi.hafur.com/2020/02/24/What-I-need-from-my-domain-provider</id><content type="html" xml:base="delphi.hafur.com/2020/02/24/What-I-need-from-my-domain-provider.html">&lt;p&gt;I started looking into the services that my domain provider offers me. With their latest service ‘optimization’, I lost the capability to log into my server using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ssh&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Maybe it is time to switch to a new provider. But what do I actually need?
Mandatory:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Email
    &lt;ul&gt;
      &lt;li&gt;Aliases. I use a lot of aliases and this is a must&lt;/li&gt;
      &lt;li&gt;Acocunts. I do not need 100 but up to 10 shuld be sufficient&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Server
    &lt;ul&gt;
      &lt;li&gt;ssh access&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Management
    &lt;ul&gt;
      &lt;li&gt;DNS management that includes A-record, CNAME, MX records, etc.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Nice to have:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;SSL certificates&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;No need for:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;website builder&lt;/li&gt;
  &lt;li&gt;online shop&lt;/li&gt;
  &lt;li&gt;analytics&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Looking at the above list, I have quite simple and straight-forward requirements which mainly focus around email.
DNS management and ssh access is an interesting point: I do not need necessarily ssh access if I have full acces to the DNS configuration because I can point my domain to any IP, i.e. any server (for which I actually have ssh access).&lt;/p&gt;

&lt;p&gt;It is a bit daring since I would be responsible to keep that server up-and-running, make sure that patches are applied, etc. Now I am not running a business so I can live with the fact that my homepage might not be available 24x7 on 365 days a year.&lt;/p&gt;

&lt;p&gt;I guess the only way of knowing what this all means is actuyally tryign it out. 
Oracle offers has an &lt;a href=&quot;https://www.oracle.com/cloud/free/&quot;&gt;‘Always Free’&lt;/a&gt; offer which might be one piece of my overall revisit of what I actually need from a domain provider.
I get (among other things) two virtual machines from Oracle for free.&lt;/p&gt;

&lt;p&gt;So - next steps are:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Get an Oracle ‘always free’ cloud account&lt;/li&gt;
  &lt;li&gt;Set up a web server in OCI&lt;/li&gt;
  &lt;li&gt;Update the A-records of my domain provider&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;…and then we see how all of that goes…&lt;/p&gt;</content><author><name></name></author><category term="cloud oracle" /><summary type="html">I started looking into the services that my domain provider offers me. With their latest service ‘optimization’, I lost the capability to log into my server using ssh.</summary></entry></feed>